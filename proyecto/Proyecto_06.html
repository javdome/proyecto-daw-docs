<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Codificación | Planificador de tareas de equipo multizona</title>
    <meta name="description" content="Proyecto fin de módulo">
    <link rel="icon" href="/proyecto-daw-docs/favicon.ico">
    
    <link rel="preload" href="/proyecto-daw-docs/assets/css/0.styles.cb8de9de.css" as="style"><link rel="preload" href="/proyecto-daw-docs/assets/js/app.3e417f56.js" as="script"><link rel="preload" href="/proyecto-daw-docs/assets/js/2.eda1a057.js" as="script"><link rel="preload" href="/proyecto-daw-docs/assets/js/10.40617687.js" as="script"><link rel="prefetch" href="/proyecto-daw-docs/assets/js/11.0b373d6b.js"><link rel="prefetch" href="/proyecto-daw-docs/assets/js/12.8f4863a1.js"><link rel="prefetch" href="/proyecto-daw-docs/assets/js/13.aa1a4952.js"><link rel="prefetch" href="/proyecto-daw-docs/assets/js/14.b9105e4e.js"><link rel="prefetch" href="/proyecto-daw-docs/assets/js/15.b972e1d1.js"><link rel="prefetch" href="/proyecto-daw-docs/assets/js/16.9cdccdcf.js"><link rel="prefetch" href="/proyecto-daw-docs/assets/js/17.2e7db2ea.js"><link rel="prefetch" href="/proyecto-daw-docs/assets/js/3.dc92d23e.js"><link rel="prefetch" href="/proyecto-daw-docs/assets/js/4.554ed953.js"><link rel="prefetch" href="/proyecto-daw-docs/assets/js/5.de65659d.js"><link rel="prefetch" href="/proyecto-daw-docs/assets/js/6.06db0e7d.js"><link rel="prefetch" href="/proyecto-daw-docs/assets/js/7.12ff65a5.js"><link rel="prefetch" href="/proyecto-daw-docs/assets/js/8.3fffd2a6.js"><link rel="prefetch" href="/proyecto-daw-docs/assets/js/9.c700acb3.js">
    <link rel="stylesheet" href="/proyecto-daw-docs/assets/css/0.styles.cb8de9de.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/proyecto-daw-docs/" class="home-link router-link-active"><img src="/proyecto-daw-docs/Logo.png" alt="Planificador de tareas de equipo multizona" class="logo"> <span class="site-name can-hide">Planificador de tareas de equipo multizona</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><a href="/proyecto-daw-docs/proyecto/" class="sidebar-link">Descripción.</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/proyecto-daw-docs/proyecto/#estructura-y-organizacion-del-departamento-de-formacion-tecnica-vw" class="sidebar-link">Estructura y organización del departamento de formación técnica VW</a></li><li class="sidebar-sub-header"><a href="/proyecto-daw-docs/proyecto/#descripcion-del-problema" class="sidebar-link">Descripción del problema</a></li><li class="sidebar-sub-header"><a href="/proyecto-daw-docs/proyecto/#objetivo" class="sidebar-link">Objetivo</a></li></ul></li><li><a href="/proyecto-daw-docs/proyecto/Proyecto_02.html" class="sidebar-link">Estado del arte. Justificación de las herramientas seleccionadas.</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/proyecto-daw-docs/proyecto/Proyecto_02.html#lado-cliente" class="sidebar-link">Lado cliente</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/proyecto-daw-docs/proyecto/Proyecto_02.html#libreria-visjs" class="sidebar-link">librería Visjs</a></li><li class="sidebar-sub-header"><a href="/proyecto-daw-docs/proyecto/Proyecto_02.html#otras-librerias-de-javascript" class="sidebar-link">Otras librerías de JavaScript</a></li><li class="sidebar-sub-header"><a href="/proyecto-daw-docs/proyecto/Proyecto_02.html#bootstrap-4" class="sidebar-link">Bootstrap 4</a></li></ul></li><li class="sidebar-sub-header"><a href="/proyecto-daw-docs/proyecto/Proyecto_02.html#lado-servidor-laravel" class="sidebar-link">Lado servidor: Laravel</a></li><li class="sidebar-sub-header"><a href="/proyecto-daw-docs/proyecto/Proyecto_02.html#otras-herramientas" class="sidebar-link">Otras herramientas</a></li></ul></li><li><a href="/proyecto-daw-docs/proyecto/Proyecto_03.html" class="sidebar-link">Estudio de viabilidad. Método DAFO.</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/proyecto-daw-docs/proyecto/Proyecto_03.html#licencia" class="sidebar-link">Licencia</a></li><li class="sidebar-sub-header"><a href="/proyecto-daw-docs/proyecto/Proyecto_03.html#estudio-de-mercado" class="sidebar-link">Estudio de mercado.</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/proyecto-daw-docs/proyecto/Proyecto_03.html#viabilidad-tecnica-economica-del-proyecto" class="sidebar-link">Viabilidad técnica/económica del proyecto</a></li><li class="sidebar-sub-header"><a href="/proyecto-daw-docs/proyecto/Proyecto_03.html#viabilidad-temporal" class="sidebar-link">Viabilidad temporal</a></li></ul></li><li class="sidebar-sub-header"><a href="/proyecto-daw-docs/proyecto/Proyecto_03.html#planificacion-temporal-o-agenda-de-trabajo" class="sidebar-link">Planificación temporal o agenda de trabajo.</a></li></ul></li><li><a href="/proyecto-daw-docs/proyecto/Proyecto_04.html" class="sidebar-link">Análisis de requisitos</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/proyecto-daw-docs/proyecto/Proyecto_04.html#descripcion-de-requisitos" class="sidebar-link">Descripción de requisitos</a></li><li class="sidebar-sub-header"><a href="/proyecto-daw-docs/proyecto/Proyecto_04.html#diagrama-de-casos-de-uso" class="sidebar-link">Diagrama de casos de uso</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/proyecto-daw-docs/proyecto/Proyecto_04.html#documentacion-de-actores" class="sidebar-link">Documentación de actores</a></li></ul></li></ul></li><li><a href="/proyecto-daw-docs/proyecto/Proyecto_05.html" class="sidebar-link">Diseño</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/proyecto-daw-docs/proyecto/Proyecto_05.html#base-de-datos" class="sidebar-link">Base de datos</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/proyecto-daw-docs/proyecto/Proyecto_05.html#diseno-conceptual-entidad-relacion" class="sidebar-link">Diseño Conceptual Entidad Relación</a></li></ul></li><li class="sidebar-sub-header"><a href="/proyecto-daw-docs/proyecto/Proyecto_05.html#orientacion-a-objetos" class="sidebar-link">Orientación a objetos</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/proyecto-daw-docs/proyecto/Proyecto_05.html#diagramas-de-clases" class="sidebar-link">Diagramas de clases.</a></li><li class="sidebar-sub-header"><a href="/proyecto-daw-docs/proyecto/Proyecto_05.html#diagrama-de-secuencias" class="sidebar-link">Diagrama de secuencias</a></li><li class="sidebar-sub-header"><a href="/proyecto-daw-docs/proyecto/Proyecto_05.html#diagrama-de-actividad" class="sidebar-link">Diagrama de actividad</a></li></ul></li><li class="sidebar-sub-header"><a href="/proyecto-daw-docs/proyecto/Proyecto_05.html#mapa-web" class="sidebar-link">Mapa web</a></li><li class="sidebar-sub-header"><a href="/proyecto-daw-docs/proyecto/Proyecto_05.html#mockups" class="sidebar-link">Mockups</a></li></ul></li><li><a href="/proyecto-daw-docs/proyecto/Proyecto_06.html" class="active sidebar-link">Codificación</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/proyecto-daw-docs/proyecto/Proyecto_06.html#planificador" class="sidebar-link">Planificador</a></li><li class="sidebar-sub-header"><a href="/proyecto-daw-docs/proyecto/Proyecto_06.html#gestion-de-escenarios-de-planificacion" class="sidebar-link">Gestión de escenarios de planificación</a></li><li class="sidebar-sub-header"><a href="/proyecto-daw-docs/proyecto/Proyecto_06.html#seguridad" class="sidebar-link">Seguridad</a></li></ul></li><li><a href="/proyecto-daw-docs/proyecto/Proyecto_07.html" class="sidebar-link">Implantación</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/proyecto-daw-docs/proyecto/Proyecto_07.html#diagrama-de-despliegue" class="sidebar-link">Diagrama de despliegue</a></li><li class="sidebar-sub-header"><a href="/proyecto-daw-docs/proyecto/Proyecto_07.html#proceso-de-despliegue" class="sidebar-link">Proceso de despliegue</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/proyecto-daw-docs/proyecto/Proyecto_07.html#primeros-pasos-y-seguridad" class="sidebar-link">Primeros pasos y seguridad</a></li><li class="sidebar-sub-header"><a href="/proyecto-daw-docs/proyecto/Proyecto_07.html#instalacion-del-servicios-y-programas-para-el-despliegue" class="sidebar-link">Instalación del servicios y programas para el despliegue</a></li></ul></li><li class="sidebar-sub-header"><a href="/proyecto-daw-docs/proyecto/Proyecto_07.html#dominio" class="sidebar-link">Dominio</a></li></ul></li><li><a href="/proyecto-daw-docs/proyecto/Proyecto_08.html" class="sidebar-link">Herramientas de apoyo</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/proyecto-daw-docs/proyecto/Proyecto_08.html#control-de-versiones-y-gestion-de-pruebas" class="sidebar-link">Control de versiones y gestión de pruebas</a></li></ul></li><li><a href="/proyecto-daw-docs/proyecto/Proyecto_09.html" class="sidebar-link">Conclusiones</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/proyecto-daw-docs/proyecto/Proyecto_09.html#conclusiones-sobre-el-trabajo-realizado" class="sidebar-link">Conclusiones sobre el trabajo realizado</a></li><li class="sidebar-sub-header"><a href="/proyecto-daw-docs/proyecto/Proyecto_09.html#conclusiones-personales" class="sidebar-link">Conclusiones personales</a></li><li class="sidebar-sub-header"><a href="/proyecto-daw-docs/proyecto/Proyecto_09.html#posibles-ampliaciones-y-mejoras" class="sidebar-link">Posibles ampliaciones y mejoras</a></li><li class="sidebar-sub-header"><a href="/proyecto-daw-docs/proyecto/Proyecto_09.html#problemas-encontrados" class="sidebar-link">Problemas encontrados</a></li></ul></li><li><a href="/proyecto-daw-docs/proyecto/Proyecto_10.html" class="sidebar-link">Bibliografía</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/proyecto-daw-docs/proyecto/Proyecto_10.html#libros-articulos-y-apuntes" class="sidebar-link">Libros, artículos y apuntes</a></li><li class="sidebar-sub-header"><a href="/proyecto-daw-docs/proyecto/Proyecto_10.html#direcciones-web" class="sidebar-link">Direcciones web</a></li></ul></li><li><a href="/proyecto-daw-docs/proyecto/Proyecto_11.html" class="sidebar-link">Anexos</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/proyecto-daw-docs/proyecto/Proyecto_11.html#diseno-logico-y-fisico-de-la-base-de-datos" class="sidebar-link">Diseño Lógico y Físico de la base de datos</a></li><li class="sidebar-sub-header"><a href="/proyecto-daw-docs/proyecto/Proyecto_11.html#notas-creadas-durante-la-evolucion-del-aplicativo" class="sidebar-link">Notas creadas durante la evolución del aplicativo</a></li></ul></li></ul> </aside> <main class="page"> <div class="content default"><h1 id="codificacion"><a href="#codificacion" aria-hidden="true" class="header-anchor">#</a> Codificación</h1> <p>A continuación se desarrolla las partes del aplicativo que considero más
interesantes desde el punto de vista de la codificación: El planificador
y la gestión de escenarios de planificaciones</p> <h2 id="planificador"><a href="#planificador" aria-hidden="true" class="header-anchor">#</a> Planificador</h2> <p>Respecto a la codificación, el planificador es la parte que más tiempo
ha consumido.</p> <p><img src="/proyecto-daw-docs/media/image23.jpeg" alt="Planificador01"></p> <p><em>Figura 22 - Vista del planificador</em></p> <p>El proceso de desarrollo del planificador ha constado de:</p> <p><strong>1.  Configuración de las opciones de ambas líneas de tiempo.</strong></p> <p>Como se puede observar en la documentación oficial
(http://visjs.org/docs/timeline/) existen multitud de opciones de
configuración. Esta configuración se realiza mediante un objeto
<em>Options</em> que posteriormente se cargará en el objeto <em>Timeline</em>. Entre
las opciones empleadas están:</p> <ul><li><p>Items editables.</p></li> <li><p>Multiselección de ítems.</p></li> <li><p>Tooltips activos.</p></li> <li><p>Escala de la línea de tiempo en días.</p></li> <li><p>Zoom máximo y mínimo.</p></li></ul> <p>Para el eje vertical, cada uno de los elementos (los instructores en
el Timeline superior, y las aulas para el Timeline inferior) se
precargan mediante un template de forma que cada elemento tenga su
funcionalidad. Esto permite que cada instructor y cada aula se pueda
ocultar, o que lo instructores incorporen sus &quot;badgets&quot; informativos.</p> <p><strong>2.  Creación de los DataSet para cada uno de los Timelines.</strong></p> <p>Además de las opciones, cada objeto Timeline se debe cargar con sus
ítems. Para ello se crean primeramente un objeto DataSet mediante un
array de objetos. Los DataSet, pertenecen a la librería Vis, y se
podría decir que son unos arrays &quot;vitaminados&quot; que incorporan sus
propios métodos y eventos (http://visjs.org/docs/data/dataset.html).</p> <p>La siguiente figura ilustra la procedencia de los datos de ambos
DataSet.</p> <p><img src="/proyecto-daw-docs/media/image24.jpeg" alt="DataSet"></p> <p><em>Figura 23 - Creación de los DataSet de instructores y aulas</em></p> <p>Es importante resaltar que una tarea concreta representada en ambas
Timeline, al venir de la misma fuente de datos, tienen el mismo
identificador. De esta forma podemos relacionar los ítems entre ambas
Timelines.</p> <p><strong>3.  Creación de las Timeline.</strong></p> <p>Una vez tenemos los objetos <em>Options</em> y los <em>DataSets</em> se pueden crear
los Timelines:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> Timeline_1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">vis<span class="token punctuation">.</span>Timeline</span><span class="token punctuation">(</span> container_1 <span class="token punctuation">,</span> DataSet_1 <span class="token punctuation">,</span> groups_1 <span class="token punctuation">,</span> options_1 <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> Timeline_2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">vis<span class="token punctuation">.</span>Timeline</span><span class="token punctuation">(</span> container_2 <span class="token punctuation">,</span> DataSet_2 <span class="token punctuation">,</span> groups_2 <span class="token punctuation">,</span> options_2 <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="warning custom-block"><p><em>container</em> son los elementos &quot;div&quot; y los <em>groups</em> son los
elementos del eje vertical (instructores y aulas, respectivamente).</p></div> <p>Para sincronizar el movimiento de ambas Timelines se emplea el evento
<em>rangechange</em> y el método <em>setWindow</em>, disponibles en los objetos
Timeline.</p> <div class="language-js extra-class"><pre class="language-js"><code>Timeline_2<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'rangechange'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">onrangechange2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Timeline_1<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'rangechange'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">onrangechange1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">onrangechange1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> range <span class="token operator">=</span> Timeline_1<span class="token punctuation">.</span><span class="token function">getWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Timeline_2<span class="token punctuation">.</span><span class="token function">setWindow</span><span class="token punctuation">(</span>range<span class="token punctuation">.</span>start<span class="token punctuation">,</span> range<span class="token punctuation">.</span>end<span class="token punctuation">,</span> <span class="token punctuation">{</span>animation<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">onrangechange2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> range <span class="token operator">=</span> Timeline_2<span class="token punctuation">.</span><span class="token function">getWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Timeline_1<span class="token punctuation">.</span><span class="token function">setWindow</span><span class="token punctuation">(</span>range<span class="token punctuation">.</span>start<span class="token punctuation">,</span> range<span class="token punctuation">.</span>end<span class="token punctuation">,</span> <span class="token punctuation">{</span>animation<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>4.  Sincronización de las tareas entre los dos Timelines</strong></p> <p>Respecto a la codificación, lo más complejo ha sido sincronizar los
movimientos de las tareas (ítems) de la líneas de tiempo entre sí, así
como el hecho de añadir o quitar el icono del maletín que indica que
el instructor está fuera de zona.</p> <p>Como se ha comentado, ambas líneas de tiempo son instancias
independientes ( Timeline_1 y Timeline_2 ), y cada una de ellas se
carga con sus tareas ( DataSet_1 y DataSet_2 ).</p> <p>Para la sincronización de las tareas, cada vez que se produce una
modificación en alguna de ellas (p.j. en DataSet_1), se genera un
evento. Este evento es &quot;cazado&quot; y se actualiza la tarea
correspondiente de la otra línea de tiempo (p.j. DataSet_2).
Recordemos que el id de la tarea es el mismo en ambos DataSet.</p> <p>Este proceso también debe ocurrir en sentido contrario, es decir, si
se modifica DataSet_2, se debe actualizar DataSet_1.</p> <p><img src="/proyecto-daw-docs/media/image25.jpeg" alt="SincronizacionItems"></p> <p><em>Figura 24 - Proceso de sincronización de Items entre ambas Timeline</em></p> <p>Todo este proceso generó los siguientes problemas que se tuvieron que
solucionar:</p> <p>Un problema es el bucle que se muestra en la imagen, es decir, si se
modifica DataSet_1, se actualiza DataSet_2. Esto genera que se
actualice DataSet_1 y, así, sucesivamente.</p> <p>Para solucionar este problema, cuando se realiza la actualización del
DataSet opuesto, se debe desactivar su listener, realizar su
actualización, y, a continuación, volver a activar el listener.</p> <p>Sin embargo, aun desactivando el listener del DataSet opuesto, seguía
teniendo problemas generados por bucles en la codificación. Estos eran
debidos a que cuando se realiza una modificación de una tarea, el
icono de la maleta siempre es actualizado en el mismo DataSet. Por lo
que se generaba un nuevo evento, que volvía a generar un bucle dentro
del mismo DataSet.</p> <p>Para solucionar esto, no solo se debe desactivar el listener del
DataSet opuesto, sino también el listener del mismo DataSet de donde
se está realizando la modificación. Al igual que antes, al finalizar
la actualización de la tarea, se debe reactivar el listener.</p> <p>También este apartado de planificación he requerido de un tiempo de
codificación en el backend. Las partes más destacables al respecto han
sido, por un lado, la adaptación de los datos de la base de datos al
formato requerido para crear los itemSet que se van a cargar en las
líneas de tiempo. Así como la fase de almacenaje de datos, en este
caso los datos son enviados vía Ajax al servidor y se han de volver a
transformar para que sean guardados.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Funciones de sincronización de tareas (ítems)</span>

<span class="token keyword">var</span> <span class="token function-variable function">modif_Item</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span> <span class="token parameter">argumentos</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    DataSet_2<span class="token punctuation">.</span><span class="token function">off</span> <span class="token punctuation">(</span> <span class="token string">'update'</span> <span class="token punctuation">,</span> modifItem2 <span class="token punctuation">)</span><span class="token punctuation">;</span>
    DataSet_1<span class="token punctuation">.</span><span class="token function">off</span> <span class="token punctuation">(</span> <span class="token string">'update'</span> <span class="token punctuation">,</span> modifItem <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token operator">...</span><span class="token operator">...</span>
    <span class="token constant">L</span>ógica de actualización de maleta en DataSet_1
    <span class="token constant">L</span>ógica de actualización de item en DataSet_2
    <span class="token operator">...</span><span class="token operator">...</span>

    DataSet_2<span class="token punctuation">.</span><span class="token function">on</span> <span class="token punctuation">(</span> <span class="token string">'update'</span> <span class="token punctuation">,</span> modifItem2 <span class="token punctuation">)</span><span class="token punctuation">;</span>
    DataSet_1<span class="token punctuation">.</span><span class="token function">on</span> <span class="token punctuation">(</span> <span class="token string">'update'</span> <span class="token punctuation">,</span> modifItem <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> <span class="token function-variable function">modif_Item2</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span> <span class="token parameter">argumentos</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    DataSet_1<span class="token punctuation">.</span><span class="token function">off</span> <span class="token punctuation">(</span> <span class="token string">'update'</span> <span class="token punctuation">,</span> modifItem <span class="token punctuation">)</span><span class="token punctuation">;</span>
    DataSet_2<span class="token punctuation">.</span><span class="token function">off</span> <span class="token punctuation">(</span> <span class="token string">'update'</span> <span class="token punctuation">,</span> modifItem2 <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token operator">...</span><span class="token operator">...</span>
    <span class="token constant">L</span>ógica de actualización de maleta en DataSet_2
    <span class="token constant">L</span>ógica de actualización de item en DataSet_1
    <span class="token operator">...</span><span class="token operator">...</span>

    DataSet_1<span class="token punctuation">.</span><span class="token function">on</span> <span class="token punctuation">(</span> <span class="token string">'update'</span> <span class="token punctuation">,</span> modifItem <span class="token punctuation">)</span><span class="token punctuation">;</span>
    DataSet_2<span class="token punctuation">.</span><span class="token function">on</span> <span class="token punctuation">(</span> <span class="token string">'update'</span> <span class="token punctuation">,</span> modifItem2 <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>

<span class="token comment">// Activación de listeners en DataSets</span>
DataSet_1<span class="token punctuation">.</span><span class="token function">on</span> <span class="token punctuation">(</span> <span class="token string">'update'</span><span class="token punctuation">,</span>modifItem <span class="token punctuation">)</span><span class="token punctuation">;</span>
DataSet_2<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span> <span class="token string">'update'</span><span class="token punctuation">,</span>modifItem2 <span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="gestion-de-escenarios-de-planificacion"><a href="#gestion-de-escenarios-de-planificacion" aria-hidden="true" class="header-anchor">#</a> Gestión de escenarios de planificación</h2> <p>En un escenario de planificación se engloban todos los datos que se
representan en el planificador, es decir: Tareas, Vacaciones, Festivos,
Instructores, Aulas y Escuelas.</p> <p>Para la gestión de escenarios de planificación, se ha creado un sistema
que guarda (o carga) todos estos datos entre la base de datos y ficheros
<em>json</em>.</p> <p>Cada fichero es un escenario distinto, mientras que el escenario que
está en la Base de datos es el <em>Escenario activo</em>, es decir, es el que
se puede modificar en el planificador.</p> <p>Cuando se quiere cambiar de escenario, los datos de la base de datos se
guardan en el fichero correspondiente, luego se vacían las tablas, y se
pasan los datos del archivo del escenario que se quiere cargar a la base
de datos.</p> <h2 id="seguridad"><a href="#seguridad" aria-hidden="true" class="header-anchor">#</a> Seguridad</h2> <p>A continuación se describen algunos sistemas de seguridad implantados en
el aplicativo:</p> <p><strong>1.  Autentificación</strong></p> <p>Laravel incorpora todo un sistema de autentificación fácilmente
integrable. Para su creación simplemente se debe emplear el comando
<em>php artisan make:auth</em>.</p> <p><strong>2.  Autorización</strong></p> <p>En el aplicativo se han creado diferentes perfiles de usuario
(instructor, responsable, administrador y superadmisnistrador) cada
uno de ellos con sus propios permisos.</p> <p>Para su desarrollo, se creado la columna <em>rol</em> en la tabla <em>users</em> y
un método para la verificación del rol en el modelo <em>User</em>. Además, se
han creado diferentes <em>Gates</em> que protegen las rutas para que no se
puedan acceder a áreas restringidas, ni realizar operaciones
peligrosas con la base de datos. Los <em>Gates</em> son el sistema de
autorización proporcionado por Laravel
(https://laravel.com/docs/authorization).</p> <p><strong>3.  Validaciones</strong></p> <p>Los formularios que realizan operaciones en la base de datos también
son validados en el servidor. Para su desarrollo, Laravel incorpora
una amplia variedad de métodos de validación
(https://laravel.com/docs/validation).</p> <p><strong>4.  Transacciones en la Base de datos</strong></p> <p>Para las acciones de borrado y guardado masivo de datos en el
servidor, se ha empleado un sistema de transacciones dentro de un
try-catch.</p> <p>De esta forma, si se procede a un vaciado de datos de la tabla para su
posterior llenado, en caso de suceder algún error, se realiza un
rollback de toda la operación.</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token constant">DB</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">beginTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">try</span> <span class="token punctuation">{</span>

    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token constant">OPERACIONES</span> <span class="token constant">EN</span> <span class="token constant">BASE</span> <span class="token constant">DE</span> <span class="token constant">DATOS</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    <span class="token constant">DB</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token double-quoted-string string">&quot;OK&quot;</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>\<span class="token package">Exception</span> <span class="token variable">$e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$error</span> <span class="token operator">=</span> <span class="token variable">$e</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token constant">DB</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">rollback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token variable">$error</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>5.  Backups de datos</strong></p> <p>En el servidor se ha creado un cron que realiza un guardado diario de
los datos (tanto de la base de datos, como de los archivos de los
escenarios).</p> <p>Para su desarrollo se ha creado un comando Artisan que realiza esta
función de backup. A continuación, se programa la ejecución del
comando en el Scheduler de Laravel. Y por último, se crea el cron en
el servidor.</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/proyecto-daw-docs/proyecto/Proyecto_05.html" class="prev">
          Diseño
        </a></span> <span class="next"><a href="/proyecto-daw-docs/proyecto/Proyecto_07.html">
          Implantación
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/proyecto-daw-docs/assets/js/app.3e417f56.js" defer></script><script src="/proyecto-daw-docs/assets/js/2.eda1a057.js" defer></script><script src="/proyecto-daw-docs/assets/js/10.40617687.js" defer></script>
  </body>
</html>
